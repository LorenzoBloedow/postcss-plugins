"use strict";var e=require("@csstools/css-tokenizer");const r=/(?:license|copyright)/i,n=/sourceMappingURL/i,t=/(?:[\s]|\/\*)/;function minify(r){if(!r||!t.test(r))return r;if(""===r.trim())return" ";const n=e.tokenize({css:r});for(let r=0;r<n.length;r++){const t=n[r];if(t[0]===e.TokenType.Comment||t[0]===e.TokenType.Whitespace){t[1]=" ";let i=n[r+1];for(;i&&(i[0]===e.TokenType.Comment||i[0]===e.TokenType.Whitespace);)i[1]="",r++,i=n[r+1]}}return e.stringify(...n)}function removeEmptyNodes(e){var r;if("rule"===e.type){if(0===(null==(r=e.nodes)?void 0:r.length)){var n;const r=e.parent;return e.remove(),0===(null==r||null==(n=r.nodes)?void 0:n.length)&&removeEmptyNodes(r),!0}}else if("atrule"===e.type){var t;if(0===(null==(t=e.nodes)?void 0:t.length)&&"layer"!==e.name.toLowerCase()){var i;const r=e.parent;return e.remove(),0===(null==r||null==(i=r.nodes)?void 0:i.length)&&removeEmptyNodes(r),!0}}return!1}const creator=()=>({postcssPlugin:"postcss-minify",OnceExit(e){e.raws={before:"",after:"\n"},e.walk((e=>{if("comment"!==e.type)if("decl"===e.type&&e.variable){var t;e.raws={...e.raws,before:minify(null==(t=e.raws)?void 0:t.before)}}else{if("atrule"===e.type){var i,o,s,l,a;if(removeEmptyNodes(e))return;return e.raws={before:minify(null==(i=e.raws)?void 0:i.before),after:minify(null==(o=e.raws)?void 0:o.after),between:minify(null==(s=e.raws)?void 0:s.between),semicolons:null==(l=e.raws)?void 0:l.semicolons,afterName:minify(null==(a=e.raws)?void 0:a.afterName)},void(e.params=minify(e.params))}if("rule"===e.type){var f,m,u;if(removeEmptyNodes(e))return;return e.raws={before:minify(null==(f=e.raws)?void 0:f.before),after:minify(null==(m=e.raws)?void 0:m.after),between:minify(null==(u=e.raws)?void 0:u.between)},void(e.selector=minify(e.selector))}var v,y,p;if("decl"===e.type)e.raws={before:minify(null==(v=e.raws)?void 0:v.before),between:minify(null==(y=e.raws)?void 0:y.between),semicolons:null==(p=e.raws)?void 0:p.semicolons,important:"decl"===e.type&&e.important?"!important":""},e.value=minify(e.value)}else{if(r.test(e.text)||n.test(e.text))return;e.remove()}}))}});creator.postcss=!0,module.exports=creator;
